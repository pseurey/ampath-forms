(globalThis.webpackChunk_openmrs_esm_patient_flags_app=globalThis.webpackChunk_openmrs_esm_patient_flags_app||[]).push([[340],{6424:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});var n=a(272),l=a.n(n),i=a(2609),r=a.n(i)()(l());r.push([e.id,".-esm-patient-flags__flags-highlight-bar__flagSummary___pL3iU{padding:.5rem;border-bottom:1px solid #e0e0e0}.-esm-patient-flags__flags-highlight-bar__flagIcon___h1s3c{margin-right:.25rem}.-esm-patient-flags__flags-highlight-bar__arrow___bezCl{margin-left:1rem}.-esm-patient-flags__flags-highlight-bar__flagsHighlightTag___j57tW{padding:0 .5rem;border:none}.-esm-patient-flags__flags-highlight-bar__flagsHighlightTag___j57tW span{display:flex;justify-content:space-between;align-items:center}.-esm-patient-flags__flags-highlight-bar__highlightBarContainer___h9iNq{padding:0 .5rem;border-bottom:1px solid #e0e0e0}.-esm-patient-flags__flags-highlight-bar__loader___eA2rM{align-items:center;display:flex;min-height:1rem;padding:1rem;width:100%}","",{version:3,sources:["webpack://./src/flags/flags-highlight-bar.scss","webpack://./../../node_modules/@carbon/layout/scss/generated/_spacing.scss"],names:[],mappings:"AAGA,8DACE,aCiBW,CDhBX,+BAAA,CAGF,2DACE,mBCOW,CDJb,wDACE,gBCkBW,CDfb,oEACE,eAAA,CACA,WAAA,CACA,yEACE,YAAA,CACA,6BAAA,CACA,kBAAA,CAIJ,wEACE,eAAA,CACA,+BAAA,CAGF,yDACE,kBAAA,CACA,YAAA,CACA,eCHW,CDIX,YCJW,CDKX,UAAA",sourceRoot:""}]),r.locals={flagSummary:"-esm-patient-flags__flags-highlight-bar__flagSummary___pL3iU",flagIcon:"-esm-patient-flags__flags-highlight-bar__flagIcon___h1s3c",arrow:"-esm-patient-flags__flags-highlight-bar__arrow___bezCl",flagsHighlightTag:"-esm-patient-flags__flags-highlight-bar__flagsHighlightTag___j57tW",highlightBarContainer:"-esm-patient-flags__flags-highlight-bar__highlightBarContainer___h9iNq",loader:"-esm-patient-flags__flags-highlight-bar__loader___eA2rM"};const s=r},9547:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});var n=a(272),l=a.n(n),i=a(2609),r=a.n(i)()(l());r.push([e.id,".-esm-patient-flags__flags__container___ap77w{display:flex;justify-content:space-between}.-esm-patient-flags__flags__flagsContainer___kHBh1{display:flex;flex-flow:row wrap;column-gap:.25rem;row-gap:.5rem;align-items:center;width:100%}.-esm-patient-flags__flags__actionButton___Onyw1{max-height:2.5rem}.-esm-patient-flags__flags__flagIcon___qNdq1{margin-right:.25rem}.-esm-patient-flags__flags__flagTag___IiNGc{padding:0 .5rem}.-esm-patient-flags__flags__flagTag___IiNGc span{display:flex;align-items:center}.-esm-patient-flags__flags__infoFlagTag___WVIlb{padding:0 .5rem;background-color:#ffd9be;color:#934412}.-esm-patient-flags__flags__highlightBarContainer___VnIXO{display:flex;align-items:center;padding:.5rem;border-bottom:1px solid #e0e0e0}.-esm-patient-flags__flags__tooltipPadding___QaVWP{padding:.25rem}.-esm-patient-flags__flags__content___OliGn p{font-size:var(--cds-body-01-font-size, 0.875rem);font-weight:var(--cds-body-01-font-weight, 400);line-height:var(--cds-body-01-line-height, 1.42857);letter-spacing:var(--cds-body-01-letter-spacing, 0.16px)}.-esm-patient-flags__flags__content___OliGn .-esm-patient-flags__flags__title___OLcFC{font-size:var(--cds-heading-compact-01-font-size, 0.875rem);font-weight:var(--cds-heading-compact-01-font-weight, 600);line-height:var(--cds-heading-compact-01-line-height, 1.28572);letter-spacing:var(--cds-heading-compact-01-letter-spacing, 0.16px)}.-esm-patient-flags__flags__content___OliGn .-esm-patient-flags__flags__message___qIKJ3{margin-top:.5rem;color:#c6c6c6}","",{version:3,sources:["webpack://./src/flags/flags.scss","webpack://./../../node_modules/@carbon/layout/scss/generated/_spacing.scss","webpack://./../../node_modules/@carbon/colors/index.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss"],names:[],mappings:"AAIA,8CACE,YAAA,CACA,6BAAA,CAGF,mDACE,YAAA,CACA,kBAAA,CACA,iBCIW,CDHX,aCQW,CDPX,kBAAA,CACA,UAAA,CAGF,iDACE,iBC2BW,CDxBb,6CACE,mBCPW,CDUb,4CACE,eAAA,CACA,iDACE,YAAA,CACA,kBAAA,CAIJ,gDACE,eAAA,CACA,wBEqCU,CFpCV,aAAA,CAGF,0DACE,YAAA,CACA,kBAAA,CACA,aCtBW,CDuBX,+BAAA,CAGF,mDACE,cChCW,CDoCX,8CG8yBE,gDAAA,CAAA,+CAAA,CAAA,mDAAA,CAAA,wDAAA,CH1yBF,sFG0yBE,2DAAA,CAAA,0DAAA,CAAA,8DAAA,CAAA,mEAAA,CHtyBF,wFACE,gBCxCS,CDyCT,aElBM",sourceRoot:""}]),r.locals={container:"-esm-patient-flags__flags__container___ap77w",flagsContainer:"-esm-patient-flags__flags__flagsContainer___kHBh1",actionButton:"-esm-patient-flags__flags__actionButton___Onyw1",flagIcon:"-esm-patient-flags__flags__flagIcon___qNdq1",flagTag:"-esm-patient-flags__flags__flagTag___IiNGc",infoFlagTag:"-esm-patient-flags__flags__infoFlagTag___WVIlb",highlightBarContainer:"-esm-patient-flags__flags__highlightBarContainer___VnIXO",tooltipPadding:"-esm-patient-flags__flags__tooltipPadding___QaVWP",content:"-esm-patient-flags__flags__content___OliGn",title:"-esm-patient-flags__flags__title___OLcFC",message:"-esm-patient-flags__flags__message___qIKJ3"};const s=r},2076:(e,t,a)=>{"use strict";a.d(t,{I0:()=>c,JT:()=>o,eF:()=>g,y$:()=>s});var n=a(268),l=a(3255),i=a(2870);function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function s(e){var t,a,n="/ws/rest/v1/patientflags/patientflag?patient=".concat(e,"&v=full"),r=(0,l.ZP)(e?n:null,i.openmrsFetch),s=r.data,o=r.error,g=r.isLoading,c=r.isValidating,_=r.mutate;return{flags:null!==(a=null==s||null===(t=s.data)||void 0===t?void 0:t.results)&&void 0!==a?a:[],error:o,isLoading:g,isValidating:c,mutate:_}}function o(){var e,t,a=(e=(0,n.useState)(window.location.pathname),t=2,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,l,i=[],r=!0,s=!1;try{for(a=a.call(e);!(r=(n=a.next()).done)&&(i.push(n.value),!t||i.length!==t);r=!0);}catch(e){s=!0,l=e}finally{try{r||null==a.return||a.return()}finally{if(s)throw l}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(a):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?r(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=a[0],i=a[1],s=(0,n.useCallback)((function(e){var t=e.detail.newUrl;i(t)}),[i]);return(0,n.useEffect)((function(){return window.addEventListener("single-spa:routing-event",s),function(){window.removeEventListener("single-spa:routing-event",s)}}),[s]),l}function g(e){var t=new AbortController,a="/ws/rest/v1/patientflags/patientflag/".concat(e);return(0,i.openmrsFetch)(a,{headers:{"Content-Type":"application/json"},method:"POST",body:{deleted:"false"},signal:t.signal})}function c(e){var t=new AbortController,a="/ws/rest/v1/patientflags/patientflag/".concat(e);return(0,i.openmrsFetch)(a,{headers:{"Content-Type":"application/json"},method:"DELETE",signal:t.signal})}},4340:(e,t,a)=>{"use strict";a.r(t),a.d(t,{editPatientFlagsWorkspace:()=>H,flagTags:()=>P,flagsOverview:()=>L,importTranslation:()=>W,startupApp:()=>O});var n=a(2870),l={},i=a(268),r=a.n(i),s=a(4724),o=a(8871),g=a(4924),c=a(2076),_=a(5362),f=a(6581),m=a(2821),u=a(321),A=a.n(u),d=a(1195),p=a.n(d),h=a(3275),C=a.n(h),y=a(7162),b=a.n(y),v=a(2094),E=a.n(v),w=a(757),B=a.n(w),k=a(9547),I={};I.styleTagTransform=B(),I.setAttributes=b(),I.insert=C().bind(null,"head"),I.domAPI=p(),I.insertStyleElement=E(),A()(k.Z,I);const T=k.Z&&k.Z.locals?k.Z.locals:void 0,N=function(e){var t=e.patientUuid,a=e.onHandleCloseHighlightBar,n=e.showHighlightBar,l=(0,g.useTranslation)().t,o=(0,c.y$)(t),u=o.flags,A=o.isLoading,d=o.error,p=u.filter((function(e){return!e.voided})),h=(0,i.useCallback)((function(){return(0,m.launchPatientWorkspace)("edit-flags-side-panel-form")}),[]),C=function(){var e=p.filter((function(e){return null==(t=e.tags)?void 0:t.filter((function(e){return e.display.includes("info")})).length;var t}));return r().createElement(r().Fragment,null,null==e?void 0:e.map((function(e){return r().createElement(s.PTL,{key:e.uuid,align:"bottom-left",direction:"right"},r().createElement(s.WBZ,{label:"Info flag"},r().createElement(s.Vp9,{key:e.uuid,className:T.infoFlagTag},e.flag.display)),r().createElement(s.Uwv,null,r().createElement("div",{className:T.content},r().createElement("p",{className:T.title},e.flag.display),r().createElement("p",{className:T.message},e.message))))})))},y=function(){var e=p.filter((function(e){return null==(t=e.tags)?void 0:t.filter((function(e){return e.display.includes("risk")})).length;var t}));return r().createElement(r().Fragment,null,e.map((function(e){return r().createElement(s.PTL,{key:e.uuid,align:"bottom-left",direction:"right"},r().createElement(s.WBZ,{label:"Risk flag"},r().createElement(s.Vp9,{key:e.uuid,type:"high-contrast",className:T.flagTag},r().createElement("span",{className:T.flagIcon},"ðŸš©")," ",e.flag.display)),r().createElement(s.Uwv,null,r().createElement("div",{className:T.content},r().createElement("p",{className:T.title},e.flag.display),r().createElement("p",{className:T.message},e.message))))})))};if(!A&&!d)return r().createElement("div",{className:T.container},r().createElement("div",{className:T.flagsContainer},r().createElement(y,null),r().createElement(C,null)),p.length>0?r().createElement(s.zxk,{className:T.actionButton,kind:"ghost",renderIcon:_.I8,onClick:h,iconDescription:l("editFlags","Edit flags")},l("edit","Edit")):null,n?r().createElement(s.zxk,{className:T.actionButton,hasIconOnly:!0,iconDescription:l("closeFlagsBar","Close flags bar"),kind:"ghost",renderIcon:f.x8,onClick:a}):null)};var F=a(6424),D={};D.styleTagTransform=B(),D.setAttributes=b(),D.insert=C().bind(null,"head"),D.domAPI=p(),D.insertStyleElement=E(),A()(F.Z,D);const S=F.Z&&F.Z.locals?F.Z.locals:void 0;function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var x="@openmrs/esm-patient-flags-app",W=a(3979);function O(){(0,n.defineConfigSchema)(x,l),(0,n.registerFeatureFlag)("patientFlags","Patient Flags","Visual components that enable healthcare providers to see relevant patient information with a glance in the Patient chart. Flags are displayed in the Patient Summary, just below the patient banner, and can link users to other areas of the chart to perform relevant actions during a visit.")}var P=(0,n.getSyncLifecycle)((function(e){var t,a,n=e.patientUuid,l=(0,c.JT)(),_=(0,g.useTranslation)().t,f=(0,c.y$)(n),m=f.flags,u=f.isLoading,A=f.error,d=m.filter((function(e){return!e.voided})).filter((function(e){return e.tags.some((function(e){return e.display.includes("risk")}))})),p=(t=(0,i.useState)(!1),a=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,l,i=[],r=!0,s=!1;try{for(a=a.call(e);!(r=(n=a.next()).done)&&(i.push(n.value),!t||i.length!==t);r=!0);}catch(e){s=!0,l=e}finally{try{r||null==a.return||a.return()}finally{if(s)throw l}}return i}}(t,a)||function(e,t){if(e){if("string"==typeof e)return j(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(a):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?j(e,t):void 0}}(t,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),h=p[0],C=p[1],y=(0,i.useCallback)((function(){C(!0)}),[]),b=(0,i.useCallback)((function(){C(!1)}),[]);return decodeURI(l).includes("Patient Summary")?null:(u&&(s.lSo,S.loader,"".concat(_("loading","Loading")," ...")),A?r().createElement("div",null,A.message):r().createElement(r().Fragment,null,d.length>0&&r().createElement(r().Fragment,null,r().createElement("div",{className:S.flagSummary},r().createElement(s.Vp9,{type:"high-contrast",onClick:y,className:S.flagsHighlightTag},r().createElement("span",{className:S.flagIcon},"ðŸš©"),r().createElement("span",{className:S.flagText},_("flagCount","{{count}} risk flags",{count:d.length})),!h&&r().createElement(o.ol,{className:S.arrow,size:16}))),h&&r().createElement("div",{className:S.highlightBarContainer},r().createElement(N,{onHandleCloseHighlightBar:b,showHighlightBar:h,patientUuid:n})))))}),{featureName:"patient-flag-tags",moduleName:x}),L=(0,n.getSyncLifecycle)(N,{featureName:"patient-flags-overview",moduleName:x}),H=(0,n.getAsyncLifecycle)((function(){return Promise.all([a.e(779),a.e(290)]).then(a.bind(a,8290))}),{featureName:"edit-flags-side-panel-form",moduleName:x})},3979:(e,t,a)=>{var n={"./am.json":[8788,788],"./ar.json":[4460,460],"./en.json":[3574,574],"./es.json":[8319,319],"./fr.json":[2757,757],"./he.json":[5833,833],"./km.json":[7807,807],"./zh.json":[8271,271],"./zh_CN.json":[1644,644]};function l(e){if(!a.o(n,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],l=t[0];return a.e(t[1]).then((()=>a(l)))}l.keys=()=>Object.keys(n),l.id=3979,e.exports=l}}]);