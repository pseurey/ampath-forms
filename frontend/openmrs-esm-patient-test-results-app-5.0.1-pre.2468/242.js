"use strict";(globalThis.webpackChunk_openmrs_esm_patient_test_results_app=globalThis.webpackChunk_openmrs_esm_patient_test_results_app||[]).push([[242],{9640:(e,t,r)=>{r.d(t,{Z:()=>l});var n=r(272),a=r.n(n),o=r(2609),i=r.n(o)()(a());i.push([e.id,':root{--brand-01: #005d5d;--brand-02: #004144;--brand-03: #007d79}.-esm-patient-test-results__common-overview__card___v1Kl3{border:1px solid #e0e0e0}.-esm-patient-test-results__common-overview__activeCard___xLUhQ{border:2px solid var(--brand-03)}.-esm-patient-test-results__common-overview__cardHeader___n2dpl:after{content:"";display:block;width:2rem;padding-top:.188rem;border-bottom:.375rem solid var(--brand-03)}.-esm-patient-test-results__common-overview__columns___RTBnO col{width:33.3%}.-esm-patient-test-results__common-overview__separator___VNmhF{height:1.5rem;border-bottom:1px solid #e0e0e0;width:calc(100% - 1.5rem);margin-left:.75rem}.-esm-patient-test-results__common-overview__meta___sWD1V{display:flex;align-items:center}.-esm-patient-test-results__common-overview__tooltipContainer___mDC16{margin:0 .5rem}.-esm-patient-test-results__common-overview__tooltip___NbQsM{font-size:var(--cds-body-compact-01-font-size, 0.875rem);font-weight:var(--cds-body-compact-01-font-weight, 400);line-height:var(--cds-body-compact-01-line-height, 1.28572);letter-spacing:var(--cds-body-compact-01-letter-spacing, 0.16px);color:#f4f4f4}.-esm-patient-test-results__common-overview__tooltip___NbQsM p{margin:.5rem 0;display:flex;align-items:baseline;justify-content:space-between}.-esm-patient-test-results__common-overview__label___Y2MTY{font-size:var(--cds-label-01-font-size, 0.75rem);font-weight:var(--cds-label-01-font-weight, 400);line-height:var(--cds-label-01-line-height, 1.33333);letter-spacing:var(--cds-label-01-letter-spacing, 0.32px);color:#c6c6c6;margin-right:.25rem}',"",{version:3,sources:["webpack://./../../node_modules/@openmrs/esm-styleguide/src/_vars.scss","webpack://./src/overview/common-overview.scss","webpack://./../../node_modules/@carbon/type/scss/_styles.scss"],names:[],mappings:"AAoDA,MACE,mBAAA,CACA,mBAAA,CACA,mBAAA,CCnDF,0DACE,wBAAA,CAGF,gEACE,gCAAA,CAIA,sEACE,UAAA,CACA,aAAA,CACA,UAAA,CACA,mBAAA,CACA,2CAAA,CAKF,iEACE,WAAA,CAIJ,+DACE,aAAA,CACA,+BAAA,CACA,yBAAA,CACA,kBAAA,CAGF,0DACE,YAAA,CACA,kBAAA,CAGF,sEACE,cAAA,CAGF,6DC8xBI,wDAAA,CAAA,uDAAA,CAAA,2DAAA,CAAA,gEAAA,CD5xBF,aD9CM,CCgDN,+DACE,cAAA,CACA,YAAA,CACA,oBAAA,CACA,6BAAA,CAIJ,2DCkxBI,gDAAA,CAAA,gDAAA,CAAA,oDAAA,CAAA,yDAAA,CDhxBF,aDlCc,CCmCd,mBAAA",sourceRoot:""}]),i.locals={card:"-esm-patient-test-results__common-overview__card___v1Kl3",activeCard:"-esm-patient-test-results__common-overview__activeCard___xLUhQ",cardHeader:"-esm-patient-test-results__common-overview__cardHeader___n2dpl",columns:"-esm-patient-test-results__common-overview__columns___RTBnO",separator:"-esm-patient-test-results__common-overview__separator___VNmhF",meta:"-esm-patient-test-results__common-overview__meta___sWD1V",tooltipContainer:"-esm-patient-test-results__common-overview__tooltipContainer___mDC16",tooltip:"-esm-patient-test-results__common-overview__tooltip___NbQsM",label:"-esm-patient-test-results__common-overview__label___Y2MTY"};const l=i},8993:(e,t,r)=>{r.d(t,{Z:()=>l});var n=r(272),a=r.n(n),o=r(2609),i=r.n(o)()(a());i.push([e.id,".-esm-patient-test-results__external-overview__recent-results-grid___6gH2U{display:grid;background-color:#fff}","",{version:3,sources:["webpack://./src/overview/external-overview.scss"],names:[],mappings:"AAAA,2EACE,YAAA,CACA,qBAAA",sourceRoot:""}]),i.locals={"recent-results-grid":"-esm-patient-test-results__external-overview__recent-results-grid___6gH2U"};const l=i},6242:(e,t,r)=>{r.r(t),r.d(t,{default:()=>oe});var n=r(268),a=r.n(n),o=r(4924),i=r(689),l=r(6759),s=r(2870),c=r(4556),u=r(5047),m=r.n(u),d=r(1827),f=r(0);function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v(e,t,r,n,a,o,i){try{var l=e[o](i),s=l.value}catch(e){return void r(e)}l.done?t(s):Promise.resolve(s).then(n,a)}function A(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){v(o,n,a,i,l,"next",e)}function l(e){v(o,n,a,i,l,"throw",e)}i(void 0)}))}}function _(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){_(e,t,r[t])}))}return e}function y(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,l=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(l)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t,r){return function(n){n.conceptClass=(0,d.Kk)(n),n.hasMember?(n.members=new Array(n.hasMember.length),n.hasMember.forEach((function(e,r){t[e.reference.split("/")[1]]=[n.members,r]}))):n.meta=r[n.conceptClass],n.valueQuantity&&(n.value=n.valueQuantity.value,delete n.valueQuantity),n.valueCodeableConcept&&(n.value=null==n?void 0:n.valueCodeableConcept.coding[0].display,delete n.valueCodeableConcept),n.name=e[n.conceptClass]}}function C(){return(C=A(m().mark((function e(t){var r,n,a,o,i,l,s,c,u,p,v;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.HZ)(t);case 2:return r=e.sent,e.next=5,(0,d.E6)(r);case 5:return n=e.sent,a=n.filter((function(e){return"Test"===e.conceptClass.name||"LabSet"===e.conceptClass.name})),o=a.map((function(e){return e.uuid})),i=Object.fromEntries(a.map((function(e){return[e.uuid,e.display]}))),l=Object.fromEntries(o.map((function(e){return[e,[]]}))),s=(0,d.OA)(a),c=[],p=g(i,u={},s),r.forEach((function(e){o.includes((0,d.Kk)(e))&&(p(e),e.members?l[e.conceptClass].push(e):c.push(e))})),c.forEach((function(e){var t=e.id,r=u[t];r&&(r[0][r[1]]=e),l[e.conceptClass]&&l[e.conceptClass].push(e)})),Object.values(l).filter((function(e){return e.some((function(e){return e.members}))})).forEach((function(e){var t=e.flatMap((function(e){return e.members})),r=(0,f.Z)(t.map((function(e){return e.conceptClass}))),n=!0,a=!1,o=void 0;try{for(var i,l=function(r,n){var a=n.value,o=c.filter((function(e){return e.conceptClass===a&&!t.some((function(t){return t.id===e.id}))})),i=!0,l=!1,s=void 0;try{for(var u,m=o[Symbol.iterator]();!(i=(u=m.next()).done);i=!0){var d=u.value;e.push(y(b({},d),{members:[d]}))}}catch(e){l=!0,s=e}finally{try{i||null==m.return||m.return()}finally{if(l)throw s}}},s=r[Symbol.iterator]();!(n=(i=s.next()).done);n=!0)l(0,i)}catch(e){a=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}})),v=Object.fromEntries(Object.entries(l).filter((function(e){return e[1].length})).map((function(e){var t=h(e,2),r=t[0],n=t[1],o=a.find((function(e){return e.uuid===r})),i=o.display,l=o.conceptClass.display;return[i,{entries:n.sort((function(e,t){return Date.parse(t.effectiveDateTime)-Date.parse(e.effectiveDateTime)})),type:l,uuid:r}]}))),r.length>0&&(0,d.s4)(t,v,r[0].id),e.abrupt("return",v);case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,l=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(l)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?w(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const O=function(e){var t=E(a().useState({sortedObs:{},loaded:!1,error:void 0}),2),r=t[0],n=t[1];return a().useEffect((function(){var t=!1;if(e){var r=E(function(e){var t=h((0,d.cF)(e),2),r=t[0],n=t[1];return[r,n.then((function(t){return t?function(e){return C.apply(this,arguments)}(e):r}))]}(e),2),a=r[0],o=r[1];a&&n({sortedObs:a,loaded:!0,error:void 0}),o.then((function(e){e===a||t||n({sortedObs:e,loaded:!0,error:void 0})}))}return function(){t=!0}}),[e]),r};function D(e,t,r){var n;return"Test"===t?[{id:e.id,name:r,range:(null===(n=e.meta)||void 0===n?void 0:n.range)||"--",interpretation:e.meta.assessValue?e.meta.assessValue(e.value):"--",value:e.value}]:e.members.map((function(e){var t;return{id:e.id,key:e.id,name:e.name,range:(null===(t=e.meta)||void 0===t?void 0:t.range)||"--",interpretation:e.meta.assessValue(e.value),value:e.value}}))}var T=r(2074),k=r(6039),S=r(8557),j=r(8828),x=r(1354),B=r.n(x),I=r(1583),M=r.n(I),N=r(7378),P=r.n(N),R=r(5993),U=r.n(R),Z=r(4154),F=r.n(Z),z=r(8141),H=r.n(z),V=r(9640),Q={};Q.styleTagTransform=H(),Q.setAttributes=U(),Q.insert=P().bind(null,"head"),Q.domAPI=M(),Q.insertStyleElement=F(),B()(V.Z,Q);const Y=V.Z&&V.Z.locals?V.Z.locals:void 0;function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function K(){return K=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},K.apply(this,arguments)}function G(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,l=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(l)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return $(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?$(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var L=function(e){var t=K({},e);return a().createElement("div",K({},t,{className:Y.separator}))},W=function(e){var t=e.effectiveDateTime,r=e.issuedDateTime,n=(0,o.useTranslation)().t;return a().createElement(i.PTL,{align:"bottom",className:Y.tooltipContainer},a().createElement(i.WBZ,{label:"Additional information"},a().createElement(S.d,null)),a().createElement(i.Uwv,null,a().createElement("div",{className:Y.tooltip},a().createElement("p",null,n("dateCollected","Displaying date collected")),a().createElement("p",null,a().createElement("span",{className:Y.label},n("resulted","Resulted"),": ")," ",(0,s.formatDatetime)(r,{mode:"wide"})),a().createElement("p",null,a().createElement("span",{className:Y.label},n("ordered","Ordered"),": ")," ",(0,s.formatDatetime)(t,{mode:"wide"})))))};const q=function(e){var t,r=e.overviewData,l=void 0===r?[]:r,u=e.openTimeline,m=e.openTrendline,d=e.insertSeparator,f=void 0!==d&&d,p=e.hideToolbar,v=void 0!==p&&p,A=e.patientUuid,_=(0,o.useTranslation)().t,b=G(a().useState(""),2),y=b[0],h=b[1],g=[{key:"name",header:"Test Name"},{key:"value",header:"Value"},{key:"range",header:"Reference Range"}],C=(0,n.useCallback)((function(e){return y===e||!y&&e===l[0][l[0].length-1]}),[y,l]),w=(0,n.useCallback)((function(){(0,s.navigate)({to:"${openmrsSpaBase}/patient/".concat(A,"/chart/test-results")})}),[A]);return l.length?a().createElement(a().Fragment,null,(t=l.map((function(e){var t=G(e,6),r=t[0],n=t[1],o=t[2],l=t[3],c=t[4],d=t[5];return a().createElement("article",{key:d,className:f?"":"".concat(Y.card," ").concat(C(d)?Y.activeCard:"")},a().createElement(j.Z,K({},{title:r,data:o,description:a().createElement("div",{className:f?"":Y.cardHeader},a().createElement("div",{className:Y.meta},(0,s.formatDatetime)(l,{mode:"wide"}),a().createElement(W,{effectiveDateTime:l,issuedDateTime:c}))),tableHeaders:g,toolbar:v||a().createElement(i.fjU,null,a().createElement(i.Vj0,null,"Test"===n&&a().createElement(i.zxk,{kind:"ghost",renderIcon:function(e){return a().createElement(T.mm,K({size:16},e))},onClick:function(){h(d),m(d,d)}},_("trend","Trend")),a().createElement(i.zxk,{kind:"ghost",renderIcon:function(e){return a().createElement(k.iA,K({size:16},e))},onClick:function(){h(d),u(d)}},_("timeline","Timeline"))))})),o.length>5&&f&&a().createElement(i.zxk,{onClick:w,kind:"ghost"},_("moreResultsAvailable","More results available")))})),f?t.reduce((function(e,t,r,n){var o=n.length;return e.push(t),r<o-1&&e.push(a().createElement(L,{key:r})),e}),[]):t)):a().createElement(c.EmptyState,{headerTitle:_("testResults_title","Test Results"),displayText:_("testResults","test results")})};var J=r(8993),X={};X.styleTagTransform=H(),X.setAttributes=U(),X.insert=P().bind(null,"head"),X.domAPI=M(),X.insertStyleElement=F(),B()(J.Z,X);const ee=J.Z&&J.Z.locals?J.Z.locals:void 0;function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function re(){return re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},re.apply(this,arguments)}function ne(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,l=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(l)throw a}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return te(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?te(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ae(e,t){return Object.entries(e).flatMap((function(e){var t=ne(e,2),r=t[0],n=t[1],a=n.entries,o=n.type,i=n.uuid;return a.map((function(e){return[e,i,o,r]}))})).filter(t).map((function(e){var t=ne(e,4),r=t[0],n=t[1],a=t[2],o=t[3];return[o,a,D(r,a,o),new Date(r.effectiveDateTime),new Date(r.issued),n]})).sort((function(e,t){var r=ne(e,4)[3];return ne(t,4)[3].getTime()-r.getTime()}))}const oe=function(e){var t=e.patientUuid,r=e.filter,u=(0,o.useTranslation)().t,m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},r=O(e),a=r.sortedObs,o=r.loaded,i=r.error;return{overviewData:(0,n.useMemo)((function(){return ae(a,t)}),[t,a]),loaded:o,error:i}}(t,r),d=m.overviewData,f=m.loaded,p=(m.error,u("recentResults","Recent Results")),v=(0,n.useCallback)((function(){(0,s.navigate)({to:"${openmrsSpaBase}/patient/".concat(t,"/chart/test-results")})}),[t]);return a().createElement(ie,null,f?a().createElement(a().Fragment,null,d.length?a().createElement("div",{className:ee.widgetCard},a().createElement("div",{className:ee.externalOverviewHeader},a().createElement("h4",{className:"".concat(ee.productiveHeading03," ").concat(ee.text02)},p),a().createElement(i.zxk,{kind:"ghost",renderIcon:function(e){return a().createElement(l.ol,re({size:16},e))},iconDescription:"See all results",onClick:v},u("seeAllResults","See all results"))),a().createElement(q,re({},{patientUuid:t,overviewData:d.slice(0,3),insertSeparator:!0,deactivateToolbar:!0,isPatientSummaryDashboard:!1,hideToolbar:!0})),d.length>3&&a().createElement(i.zxk,{onClick:v,kind:"ghost"},u("moreResultsAvailable","More results available"))):a().createElement(c.EmptyState,{headerTitle:p,displayText:u("recentTestResults","recent test results")})):a().createElement(i.gqd,{columnCount:3}))};var ie=function(e){return a().createElement("div",re({},e,{className:ee["recent-results-grid"]}))}}}]);