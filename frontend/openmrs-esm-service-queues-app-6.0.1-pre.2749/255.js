/*! For license information please see 255.js.LICENSE.txt */
"use strict";(globalThis.webpackChunk_openmrs_esm_service_queues_app=globalThis.webpackChunk_openmrs_esm_service_queues_app||[]).push([[255],{452:(e,n,t)=>{var r=t(5206),i="function"==typeof Object.is?Object.is:function(e,n){return e===n&&(0!==e||1/e==1/n)||e!=e&&n!=n},s=r.useState,a=r.useEffect,u=r.useLayoutEffect,o=r.useDebugValue;function d(e){var n=e.getSnapshot;e=e.value;try{var t=n();return!i(e,t)}catch(e){return!0}}var c="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,n){return n()}:function(e,n){var t=n(),r=s({inst:{value:t,getSnapshot:n}}),i=r[0].inst,c=r[1];return u((function(){i.value=t,i.getSnapshot=n,d(i)&&c({inst:i})}),[e,t,n]),a((function(){return d(i)&&c({inst:i}),e((function(){d(i)&&c({inst:i})}))}),[e]),o(t),t};n.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:c},3100:(e,n,t)=>{e.exports=t(452)},3255:(e,n,t)=>{t.d(n,{JG:()=>s.mutate,ZP:()=>u});var r=t(5206),i=t(3100),s=t(3325);const a={dedupe:!0};s.OBJECT.defineProperty(s.SWRConfig,"defaultValue",{value:s.defaultConfig});var u=(0,s.withArgs)(((e,n,t)=>{const{cache:u,compare:o,suspense:d,fallbackData:c,revalidateOnMount:l,refreshInterval:f,refreshWhenHidden:E,refreshWhenOffline:g,keepPreviousData:v}=t,[p,S,h]=s.SWRGlobalState.get(u),[m,b]=(0,s.serialize)(e),U=(0,r.useRef)(!1),_=(0,r.useRef)(!1),R=(0,r.useRef)(m),C=(0,r.useRef)(n),T=(0,r.useRef)(t),y=()=>T.current,V=()=>y().isVisible()&&y().isOnline(),[w,k,I]=(0,s.createCacheHelper)(u,m),L=(0,r.useRef)({}).current,O=(0,s.isUndefined)(c)?t.fallback[m]:c,D=(e,n)=>{let t=!0;for(const r in L){const i=r;o(n[i],e[i])||"data"===i&&(0,s.isUndefined)(e[i])&&o(n[i],W)||(t=!1)}return t},N=(0,r.useMemo)((()=>{const e=!!m&&!!n&&((0,s.isUndefined)(l)?!y().isPaused()&&!d:l),t=()=>{const n=w(),t=(0,s.mergeObjects)(n);return delete t._k,e?{isValidating:!0,isLoading:!0,...t}:t};let r=t();return()=>{const e=t();return D(e,r)?r:r=e}}),[u,m]),F=(0,i.useSyncExternalStore)((0,r.useCallback)((e=>I(m,((n,t)=>{D(n,t)||e()}))),[u,m]),N,N),A=!U.current,P=F.data,x=(0,s.isUndefined)(P)?O:P,G=F.error,M=(0,r.useRef)(x),W=v?(0,s.isUndefined)(P)?M.current:P:x,j=A&&!(0,s.isUndefined)(l)?l:!y().isPaused()&&(d?!(0,s.isUndefined)(x)&&t.revalidateIfStale:(0,s.isUndefined)(x)||t.revalidateIfStale),q=!!(m&&n&&A&&j),H=(0,s.isUndefined)(F.isValidating)?q:F.isValidating,J=(0,s.isUndefined)(F.isLoading)?q:F.isLoading,Y=(0,r.useCallback)((async e=>{const n=C.current;if(!m||!n||_.current||y().isPaused())return!1;let r,i,a=!0;const u=e||{},d=!h[m]||!u.dedupe,c=()=>s.IS_REACT_LEGACY?!_.current&&m===R.current&&U.current:m===R.current,l={isValidating:!1,isLoading:!1},f=()=>{k(l)},E=()=>{const e=h[m];e&&e[1]===i&&delete h[m]},g={isValidating:!0};(0,s.isUndefined)(w().data)&&(g.isLoading=!0);try{if(d&&(k(g),t.loadingTimeout&&(0,s.isUndefined)(w().data)&&setTimeout((()=>{a&&c()&&y().onLoadingSlow(m,t)}),t.loadingTimeout),h[m]=[n(b),(0,s.getTimestamp)()]),[r,i]=h[m],r=await r,d&&setTimeout(E,t.dedupingInterval),!h[m]||h[m][1]!==i)return d&&c()&&y().onDiscarded(m),!1;l.error=s.UNDEFINED;const e=S[m];if(!(0,s.isUndefined)(e)&&(i<=e[0]||i<=e[1]||0===e[1]))return f(),d&&c()&&y().onDiscarded(m),!1;const u=w().data;l.data=o(u,r)?u:r,d&&c()&&y().onSuccess(r,m,t)}catch(e){E();const n=y(),{shouldRetryOnError:t}=n;n.isPaused()||(l.error=e,d&&c()&&(n.onError(e,m,n),(!0===t||(0,s.isFunction)(t)&&t(e))&&V()&&n.onErrorRetry(e,m,n,Y,{retryCount:(u.retryCount||0)+1,dedupe:!0})))}return a=!1,f(),!0}),[m,u]),z=(0,r.useCallback)(((...e)=>(0,s.internalMutate)(u,R.current,...e)),[]);if((0,s.useIsomorphicLayoutEffect)((()=>{C.current=n,T.current=t,(0,s.isUndefined)(P)||(M.current=P)})),(0,s.useIsomorphicLayoutEffect)((()=>{if(!m)return;const e=Y.bind(s.UNDEFINED,a);let n=0;const t=(0,s.subscribeCallback)(m,p,(t=>{if(t==s.revalidateEvents.FOCUS_EVENT){const t=Date.now();y().revalidateOnFocus&&t>n&&V()&&(n=t+y().focusThrottleInterval,e())}else if(t==s.revalidateEvents.RECONNECT_EVENT)y().revalidateOnReconnect&&V()&&e();else if(t==s.revalidateEvents.MUTATE_EVENT)return Y()}));return _.current=!1,R.current=m,U.current=!0,k({_k:b}),j&&((0,s.isUndefined)(x)||s.IS_SERVER?e():(0,s.rAF)(e)),()=>{_.current=!0,t()}}),[m]),(0,s.useIsomorphicLayoutEffect)((()=>{let e;function n(){const n=(0,s.isFunction)(f)?f(x):f;n&&-1!==e&&(e=setTimeout(t,n))}function t(){w().error||!E&&!y().isVisible()||!g&&!y().isOnline()?n():Y(a).then(n)}return n(),()=>{e&&(clearTimeout(e),e=-1)}}),[f,E,g,m]),(0,r.useDebugValue)(W),d&&(0,s.isUndefined)(x)&&m){if(!s.IS_REACT_LEGACY&&s.IS_SERVER)throw new Error("Fallback data is required when using suspense in SSR.");throw C.current=n,T.current=t,_.current=!1,(0,s.isUndefined)(G)?Y(a):G}return{mutate:z,get data(){return L.data=!0,W},get error(){return L.error=!0,G},get isValidating(){return L.isValidating=!0,H},get isLoading(){return L.isLoading=!0,J}}}))}}]);